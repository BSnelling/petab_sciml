<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Format · PEtab SciML extension</title><meta name="title" content="Format · PEtab SciML extension"/><meta property="og:title" content="Format · PEtab SciML extension"/><meta property="twitter:title" content="Format · PEtab SciML extension"/><meta name="description" content="Documentation for PEtab SciML extension."/><meta property="og:description" content="Documentation for PEtab SciML extension."/><meta property="twitter:description" content="Documentation for PEtab SciML extension."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">PEtab SciML extension</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><a class="tocitem" href="tutorial.html">Tutorial</a></li><li class="is-active"><a class="tocitem" href="format.html">Format</a><ul class="internal"><li><a class="tocitem" href="#hybrid_types"><span>High Level Overview</span></a></li><li><a class="tocitem" href="#net_format"><span>Neural Network Model Format</span></a></li><li><a class="tocitem" href="#mapping_table"><span>Mapping Table</span></a></li><li><a class="tocitem" href="#hybrid_table"><span>Hybridization Table</span></a></li><li><a class="tocitem" href="#parameter_table"><span>Parameter Table</span></a></li><li><a class="tocitem" href="#YAML_file"><span>Problem YAML File</span></a></li></ul></li><li><a class="tocitem" href="net_activation.html">Supported Layers and Activation Functions</a></li><li><a class="tocitem" href="test_info.html">Test Suite</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="format.html">Format</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="format.html">Format</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sebapersson/petab_sciml" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/sebapersson/petab_sciml/blob/main/docs/src/format.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Format-Specification"><a class="docs-heading-anchor" href="#Format-Specification">Format Specification</a><a id="Format-Specification-1"></a><a class="docs-heading-anchor-permalink" href="#Format-Specification" title="Permalink"></a></h1><p>A PEtab SciML problem extends the PEtab standard version 2 to accommodate hybrid models (SciML problems) that combine neural network and mechanistic components. Two new file types are introduced by the extension:</p><ol><li><a href="format.html#net_format">Neural Net File(s)</a>: Optional YAML file(s) describing neural net model(s).</li><li><a href="format.html#hybrid_table">Hybridization table</a>: Table for assigning neural network outputs and inputs.</li></ol><p>PEtab SciML further extends the following standard PEtab files:</p><ol><li><a href="format.html#mapping_table">Mapping Table</a>: Extended to describe how neural network inputs, outputs and parameters map to PEtab variables.</li><li><a href="format.html#parameter_table">Parameters Table</a>: Extended to describe nominal values for network parameters.</li><li><a href="format.html#YAML_file">Problem YAML File</a>: Extended to include a new SciML field for neural network models and (optionally) array or tensor formatted data.</li></ol><p>All other PEtab files remain unchanged. This specification explains the format for each file that is added or modified by the PEtab SciML extension.</p><h2 id="hybrid_types"><a class="docs-heading-anchor" href="#hybrid_types">High Level Overview</a><a id="hybrid_types-1"></a><a class="docs-heading-anchor-permalink" href="#hybrid_types" title="Permalink"></a></h2><p>The PEtab SciML specification is designed to keep the dynamic model, neural network model, and PEtab problem as independent as possible while linking them through the hybridization and/or condition tables. In this context, mechanistic models are typically defined using community standards like SBML and are commonly simulated as systems of ordinary differential equations (ODEs), and here the terms mechanistic model and ODE are used interchangeably. Essentially, the PEtab SciML approach takes a PEtab problem involving a mechanistic ODE model and supports the integration of neural network inputs and outputs.</p><p>PEtab SciML supports two classes of hybrid models:</p><ol><li><strong>Pre simulation hybridization</strong>: The neural network model sets constant parameters and/or initial values in the ODE model prior to model simulation. Inputs are constant per simulation condition.</li><li><strong>Intra simulation hybridization</strong>: The neural network model appears in the ODE right-hand-side (RHS) and/or observable formula. Inputs are per time-point computed from simulated quantities.</li></ol><p>A PEtab SciML problem can also include multiple neural networks. Aside from ensuring that neural networks do not conflict (e.g., by sharing the same output), no special considerations are required. Each additional network is included just as it would be in the single-network case.</p><h2 id="net_format"><a class="docs-heading-anchor" href="#net_format">Neural Network Model Format</a><a id="net_format-1"></a><a class="docs-heading-anchor-permalink" href="#net_format" title="Permalink"></a></h2><p>The neural network model format is flexible, meaning models can be provided in any format compatible with the PEtab SciML specification (for example, <a href="https://github.com/LuxDL/Lux.jl">Lux.jl</a> in <a href="https://github.com/sebapersson/PEtab.jl">PEtab.jl</a>). Additionally, the <code>petab_sciml</code> library provides a neural network YAML file format that can be imported by tools across various programming languages. This format flexibility exists because, although the YAML format can accommodate many architectures, some may still be difficult to represent. However, the YAML format is recommended whenever possible to facilitate model exchange.</p><p>A neural network model must consist of two parts to be compatible with the PEtab SciML specification:</p><ul><li><strong>layers</strong>: A constructor that defines the network layers, each with a unique identifier.</li><li><strong>forward</strong>: A forward pass function that, given input arguments, specifies the order in which layers are called, applies any activation functions, and returns one or several arrays. The forward function can accept more than one input argument (<code>n &gt; 1</code>), and in the <a href="format.html#mapping_table">mapping table</a>, the forward function&#39;s <code>n</code>th input argument (ignoring any potential class arguments such as <code>self</code>) is referred to as <code>inputArgumentIndex{n}</code>. Similar holds for the output. Aside from the neural network output values, every component that should be visible to other parts of the PEtab SciML problem must be defined elsewhere (e.g., in <strong>layers</strong>).</li></ul><h3 id="hdf5_ps_structure"><a class="docs-heading-anchor" href="#hdf5_ps_structure">Neural Network Parameters</a><a id="hdf5_ps_structure-1"></a><a class="docs-heading-anchor-permalink" href="#hdf5_ps_structure" title="Permalink"></a></h3><p>All parameters for a neural network model are stored in an HDF5 file, with the file path specified in the problem <a href="format.html#YAML_file">YAML file</a>. The HDF5 parameter file is expected to have the following structure for an arbitrary number of layers:</p><pre><code class="language-hdf5 hljs">parameters.hdf5
└───layerId{1} (group)
│   ├── arrayId{1}
│   └── arrayId{2}
└───layerId{2} (group)
    ├── arrayId{1}
    └── arrayId{2}</code></pre><p>The indexing convention and naming for <code>arrayId</code> depend on the neural network model library:</p><ul><li>Neural network models in the PEtab SciML <a href="format.html#YAML_net_format">YAML format</a> follow PyTorch indexing and naming conventions. For example, in a PyTorch <code>linear</code> layer, the arrays ids are <code>weight</code> and (optionally) <code>bias</code></li><li>Neural network models in other formats follow the indexing and naming conventions of the respective package and programming language.</li></ul><h3 id="hdf5_input_structure"><a class="docs-heading-anchor" href="#hdf5_input_structure">Neural Network Input</a><a id="hdf5_input_structure-1"></a><a class="docs-heading-anchor-permalink" href="#hdf5_input_structure" title="Permalink"></a></h3><p>Potential neural network input files are expected to have the following format:</p><pre><code class="language-hdf5 hljs">input.hdf5
└───input (group)
    └─── input_array</code></pre><p>As with <a href="format.html#hdf5_ps_structure">parameters</a>, the indexing depends on the neural network library:</p><ul><li>Neural network models in the PEtab SciML <a href="format.html#YAML_net_format">YAML format</a> follow PyTorch indexing. For example, if the first layer is <code>Conv2d</code>, the input should be in <code>(C, W, H)</code> format.</li><li>Neural network models in other formats follow the indexing and naming conventions of the respective package and programming language.</li></ul><div class="admonition is-success"><header class="admonition-header">For developers: Respect memory order</header><div class="admonition-body"><p>Tools supporting the SciML extension should, for computational efficiency, reorder input data and potential layer parameter arrays to match the memory ordering of the target language. For example, PEtab.jl converts input data to follow Julia based indexing.</p></div></div><p>TODO: We will fix condition specific input in the YAML file later.</p><h3 id="YAML_net_format"><a class="docs-heading-anchor" href="#YAML_net_format">YAML Network file format</a><a id="YAML_net_format-1"></a><a class="docs-heading-anchor-permalink" href="#YAML_net_format" title="Permalink"></a></h3><p>The <code>petab_sciml</code> library provides a YAML neural network file format for model exchange. The YAML format follows PyTorch conventions for layer names and arguments. While YAML network files can be written manually, it is recommended approach to define a PyTorch <code>nn.Module</code> and use the <code>petab_sciml</code> library to automatically generate the YAML representation (see tutorials).</p><p>TODO: Should we have some description of the YAML format here? (can and should probably be added later)</p><h2 id="mapping_table"><a class="docs-heading-anchor" href="#mapping_table">Mapping Table</a><a id="mapping_table-1"></a><a class="docs-heading-anchor-permalink" href="#mapping_table" title="Permalink"></a></h2><p>All neural networks are assigned an Id in the PEtab problem <a href="format.html#YAML_file">YAML</a> file. A neural network Id is not considered a valid PEtab identifier, to avoid confusion about what it refers to (e.g., parameters, inputs, outputs). Consequently, every neural network input, parameter, and output referenced in the PEtab problem must be defined under <code>modelEntityId</code> and mapped to a PEtab identifier. For the <code>PEtabEntityId</code> column the same rules as in PEtab v2 apply, and additionally array file Ids defined in the <a href="format.html#YAML_file">YAML</a> file are considered valid PEtab entities.</p><h3 id="modelEntityId-[STRING,-REQUIRED]"><a class="docs-heading-anchor" href="#modelEntityId-[STRING,-REQUIRED]"><code>modelEntityId</code> [STRING, REQUIRED]</a><a id="modelEntityId-[STRING,-REQUIRED]-1"></a><a class="docs-heading-anchor-permalink" href="#modelEntityId-[STRING,-REQUIRED]" title="Permalink"></a></h3><p>A modeling-language-independent syntax which refers to inputs, outputs, and parameters of neural networks.</p><h4 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h4><p>The model Id <code>$netId.parameters[$layerId].{[$arrayId]{[$parameterIndex]}}</code> refers to the parameters of a neural network identified by <code>$netId</code>.</p><ul><li><code>$layerId</code>: The unique identifier of the layer (e.g., <code>conv1</code>).</li><li><code>$arrayId</code>: The parameter array name specific to that layer (e.g., <code>weight</code>).</li><li><code>$parameterIndex</code>: The indexing into the parameter array (<a href="format.html#mapping_table_indexing">syntax</a>).</li></ul><h4 id="Inputs"><a class="docs-heading-anchor" href="#Inputs">Inputs</a><a id="Inputs-1"></a><a class="docs-heading-anchor-permalink" href="#Inputs" title="Permalink"></a></h4><p>The model Id <code>$netId.inputs{[$inputArgumentIndex]{[$inputIndex]}}</code> refers to specific inputs of the network identified by <code>$netId</code>.</p><ul><li><code>$inputArgumentIndex</code>: The input argument number in the neural network forward function. Starts from 1.</li><li><code>$inputIndex</code> Indexing into the input argument (<a href="format.html#mapping_table_indexing">syntax</a>). Should not be specified if the input is a file.</li></ul><h4 id="Outputs"><a class="docs-heading-anchor" href="#Outputs">Outputs</a><a id="Outputs-1"></a><a class="docs-heading-anchor-permalink" href="#Outputs" title="Permalink"></a></h4><p>The model Id <code>$netId.outputs{[outputArgumentIndex]{[$outputIndex]}}</code> refers to specific outputs of a neural network identified by <code>$netId</code>.</p><ul><li><code>$outputId</code>: The output argument number in the neural network forward function. Starts from 1.</li><li><code>$outputIndex</code>: Indexing into the output argument (<a href="format.html#mapping_table_indexing">syntax</a>)</li></ul><h4 id="Nested-Identifiers"><a class="docs-heading-anchor" href="#Nested-Identifiers">Nested Identifiers</a><a id="Nested-Identifiers-1"></a><a class="docs-heading-anchor-permalink" href="#Nested-Identifiers" title="Permalink"></a></h4><p>The PEtab SciML extension supports nested identifiers for mapping structured or hierarchical elements. Identifiers are expressed in the hierarchical indicated above using nested curly brackets. Valid examples are:</p><ul><li><code>net1.parameters</code></li><li><code>net1.parameters[conv1]</code></li><li><code>net1.parameters[conv1].weight</code></li></ul><div class="admonition is-category-warn"><header class="admonition-header">Do not break the hierarchy</header><div class="admonition-body"><p>Identifiers that break the hierarchy (e.g., <code>net1.parameters.weight</code>) are not valid.</p></div></div><h4 id="mapping_table_indexing"><a class="docs-heading-anchor" href="#mapping_table_indexing">Indexing</a><a id="mapping_table_indexing-1"></a><a class="docs-heading-anchor-permalink" href="#mapping_table_indexing" title="Permalink"></a></h4><p>Indexing into arrays follows the format <code>[i1, i2, ...]</code>, and indexing notation depends on the neural network library:</p><ul><li>Neural network models in the PEtab SciML <a href="format.html#YAML_net_format">YAML format</a> follow PyTorch indexing. Consequently, indexing is 0-based.</li><li>Neural network models in other formats follow the indexing and naming conventions of the respective package and programming language.</li></ul><h4 id="Assigning-Values"><a class="docs-heading-anchor" href="#Assigning-Values">Assigning Values</a><a id="Assigning-Values-1"></a><a class="docs-heading-anchor-permalink" href="#Assigning-Values" title="Permalink"></a></h4><p>For assignments to nested PEtab identifiers (in the <code>parameters</code>, <code>hybridisations</code>, or <code>conditions</code> tables), assigned values must either:</p><ul><li>Refer to another PEtab identifier with the same nested structure, or</li><li>Follow the corresponding hierarchical HDF5 <a href="format.html#hdf5_input_structure">input</a> or <a href="format.html#hdf5_ps_structure">parameter</a> structure.</li></ul><h2 id="hybrid_table"><a class="docs-heading-anchor" href="#hybrid_table">Hybridization Table</a><a id="hybrid_table-1"></a><a class="docs-heading-anchor-permalink" href="#hybrid_table" title="Permalink"></a></h2><p>A tab-separated values file for assigning neural network inputs and outputs. Assignments in the table the table apply to all simulation conditions. Expected to have, in any order, the following two columns:</p><table><tr><th style="text-align: right"><strong>targetId</strong></th><th style="text-align: right"><strong>targetValue</strong></th></tr><tr><td style="text-align: right">NON_ESTIMATED_ENTITY_ID</td><td style="text-align: right">MATH_EXPRESSION</td></tr><tr><td style="text-align: right">net1_input1</td><td style="text-align: right">p1</td></tr><tr><td style="text-align: right">net1_input2</td><td style="text-align: right">p1</td></tr><tr><td style="text-align: right">...</td><td style="text-align: right">...</td></tr></table><h3 id="Detailed-Field-Description"><a class="docs-heading-anchor" href="#Detailed-Field-Description">Detailed Field Description</a><a id="Detailed-Field-Description-1"></a><a class="docs-heading-anchor-permalink" href="#Detailed-Field-Description" title="Permalink"></a></h3><ul><li><code>targetId</code> [NON_ESTIMATED_ENTITY_ID, REQUIRED]: The identifier of the non-estimated entity that will be modified. Restrictions depend on hybridization type (<a href="format.html#hybrid_types">pre- or intra-simulation hybridization</a>). See below.</li><li><code>targetValue</code> [STRING, REQUIRED]: The value or expression that will be used to change the target.</li></ul><h3 id="Pre-simulation-hybridization"><a class="docs-heading-anchor" href="#Pre-simulation-hybridization">Pre-simulation hybridization</a><a id="Pre-simulation-hybridization-1"></a><a class="docs-heading-anchor-permalink" href="#Pre-simulation-hybridization" title="Permalink"></a></h3><p>Pre-simulation neural network model inputs and outputs are constant targets (see case 1 <a href="format.html#hybrid_types">here</a>).</p><h4 id="Inputs-2"><a class="docs-heading-anchor" href="#Inputs-2">Inputs</a><a class="docs-heading-anchor-permalink" href="#Inputs-2" title="Permalink"></a></h4><p>Valid <code>targetValue</code>&#39;s for a neural network input are:</p><ul><li>A parameter in the parameter table.</li><li>An array input file (assigned an Id in the <a href="format.html#YAML_file">YAML problem file</a>).</li></ul><h4 id="Outputs-2"><a class="docs-heading-anchor" href="#Outputs-2">Outputs</a><a class="docs-heading-anchor-permalink" href="#Outputs-2" title="Permalink"></a></h4><p>Valid <code>targetId</code>&#39;s for a neural network output are:</p><ul><li>A non-estimated model parameter.</li><li>A specie&#39;s initial value (referenced by the specie&#39;s Id). In this case, any other specie initialization is overridden.</li></ul><h4 id="Condition-and-Hybridization-Tables"><a class="docs-heading-anchor" href="#Condition-and-Hybridization-Tables">Condition and Hybridization Tables</a><a id="Condition-and-Hybridization-Tables-1"></a><a class="docs-heading-anchor-permalink" href="#Condition-and-Hybridization-Tables" title="Permalink"></a></h4><p>Pre-simulation assignments can alternatively be made in the conditions table. Combinations are also permitted, for example, all inputs can be assigned in the condition table while all outputs are assigning in the hybridization table. <strong>Importantly</strong>, since the hybridization table defines assignments for all simulation conditions, any <code>targetId</code> assigned in the condition table cannot be assigned in the hybridization table, and vice versa.</p><h3 id="Intra-simulation-hybridization"><a class="docs-heading-anchor" href="#Intra-simulation-hybridization">Intra-simulation hybridization</a><a id="Intra-simulation-hybridization-1"></a><a class="docs-heading-anchor-permalink" href="#Intra-simulation-hybridization" title="Permalink"></a></h3><p>Intra-simulation neural network models depend on model simulated model quantities (see case 2 <a href="format.html#hybrid_types">here</a>).</p><h4 id="Inputs-3"><a class="docs-heading-anchor" href="#Inputs-3">Inputs</a><a class="docs-heading-anchor-permalink" href="#Inputs-3" title="Permalink"></a></h4><p>Valid <code>targetValue</code> for a neural network input is an expression that depend on model species, time, and/or parameters. Any model species and/or parameters in the expression are expected to be evaluated at the given time-value.</p><h4 id="Outputs-3"><a class="docs-heading-anchor" href="#Outputs-3">Outputs</a><a class="docs-heading-anchor-permalink" href="#Outputs-3" title="Permalink"></a></h4><p>Valid <code>targetId</code> for a neural network output is a constant model parameter. During PEtab problem import, any assigned parameters is replaced by the neural network output in the ODE RHS.</p><p><strong>Importantly</strong>, it is invalid for a model parameter assigned by a neural network output to appear in both the ODE RHS and the observable formula. In the observable formula, neural network output PEtab identifiers are expected to be directly encoded, making a neural network–assigned parameter in the formula ambiguous. Conversely, it is considered valid if a neural network output is used to assign an ODE model parameter and is also directly encoded in the observable formula.</p><h2 id="parameter_table"><a class="docs-heading-anchor" href="#parameter_table">Parameter Table</a><a id="parameter_table-1"></a><a class="docs-heading-anchor-permalink" href="#parameter_table" title="Permalink"></a></h2><p>The parameter table follows the same format as in PEtab version 2, with a subset of fields extended to accommodate neural network parameters. This section focuses on columns extended by the SciML extension.</p><div class="admonition is-info"><header class="admonition-header">Specific Assignments Have Precedence</header><div class="admonition-body"><p>More specific assignments (e.g., <code>netId.parameters[layerId]</code> instead of <code>netId.parameters</code>) have precedence for nominal values, priors, and other setting. For example, if a nominal values is assigned to <code>netId.parameters</code> and a different nominal value is assigned to <code>netId.parameters[layerId]</code>, the latter is used.</p></div></div><h3 id="Detailed-Field-Description-2"><a class="docs-heading-anchor" href="#Detailed-Field-Description-2">Detailed Field Description</a><a class="docs-heading-anchor-permalink" href="#Detailed-Field-Description-2" title="Permalink"></a></h3><ul><li><code>parameterId</code> [String, REQUIRED]: The neural network or a specific layer/parameter array id. The target of the <code>parameterId</code> must be assigned via the <a href="format.html#mapping_table">mapping table</a>.</li><li><code>nominalValue</code> [String | NUMERIC, REQUIRED]: Neural network nominal values. This can be:<ul><li>A PEtab variable that via the problem <a href="format.html#YAML_file">YAML file</a> corresponds to an HDF5 file with the required <a href="format.html#hdf5_ps_structure">structure</a>. If no file exists at the given path when the problem is imported and the parameters are set to be estimated, a file is created with randomly sampled values. Unless a numeric value is provided, referring to the same file is required for all assignments for a neural network, since all neural network parameters should be collected in a single HDF5 file following the structure described <a href="format.html#hdf5_ps_structure">here</a>.</li><li>A numeric value applied to all parameters under <code>parameterId</code>.</li></ul></li><li><code>estimate</code> [0 | 1, REQUIRED]: Indicates whether the parameters are estimated (<code>1</code>) or fixed (<code>0</code>). This must be consistent across layers. For example, if <code>netId.parameters</code> has <code>estimate = 0</code>, then potential layer rows must also be <code>0</code>. In other words, freezing individual network parameters is not allowed.</li></ul><h3 id="Bounds-for-neural-net-parameters"><a class="docs-heading-anchor" href="#Bounds-for-neural-net-parameters">Bounds for neural net parameters</a><a id="Bounds-for-neural-net-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Bounds-for-neural-net-parameters" title="Permalink"></a></h3><p>Bounds can be specified for an entire network or its nested identifiers. However, most optimization algorithms used for neural networks, such as ADAM, do not support parameter bounds in their standard implementations. Therefore, neural net bounds are optional and default to <code>-inf</code> for the lower bound and <code>inf</code> for the upper bound.</p><h2 id="YAML_file"><a class="docs-heading-anchor" href="#YAML_file">Problem YAML File</a><a id="YAML_file-1"></a><a class="docs-heading-anchor-permalink" href="#YAML_file" title="Permalink"></a></h2><p>An extension section is included in the PEtab SciML YAML file for specifying neural network YAML files, as well as array parameter, input, and output files. These elements are defined using the following key-value mappings:</p><ul><li><code>file[extensions][petab_sciml][neural_nets]</code>: Neural network models. Each network is defined as a key-value mapping, where the key is the unique neural network Id (<code>netId</code>), and the corresponding value is another key-value mapping:<ul><li><code>[netId][location]</code>: The file path where the neural network model is stored.</li><li><code>[netId][format]</code>: The neural network format. Expected to be <code>YAML</code> if the network is provided in the PEtab SciML library <a href="format.html#YAML_net_format">YAML format</a>. Otherwise, the neural network library should be provided (e.g Lux.jl or equinox.py).</li><li><code>[netId][hybridization]</code>: The neural network hybridization type. Expected to be either <code>pre_simulation</code> or <code>intra_simulation</code> (for type information see <a href="format.html#hybrid_types">here</a>).</li></ul></li><li><code>yaml_file[extensions][petab_sciml][array_files]</code>  Potential array files. Parameter files are expected to follow the structure described <a href="format.html#hdf5_ps_structure">here</a>, and input files should follow the structure described <a href="format.html#hdf5_input_structure">here</a>. Each entry is defined with a key-value mapping where the key is the array Id (<code>arrayId</code>), and the corresponding value is another key-value mapping:<ul><li><code>[arrayId][location]</code>: The file path.</li><li><code>[arrayId][format]</code>: The file format (e.g., HDF5).</li></ul></li></ul><p>If a neural network is provided in another format than the YAML format, respective tool must provide the network during problem import. Note that regardless of neural-network format, for exchange purposes the neural network model <strong>must</strong> be available in a file (not in the main PEtab problem import script).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="tutorial.html">« Tutorial</a><a class="docs-footer-nextpage" href="net_activation.html">Supported Layers and Activation Functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Tuesday 25 March 2025 16:41">Tuesday 25 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
